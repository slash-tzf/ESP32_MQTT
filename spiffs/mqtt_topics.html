<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0">
  <title>ESP-MQTTä¸»é¢˜</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="icon" href="./img/favicon.ico">
  <style>
    /* MQTTä¸»é¢˜é¡µé¢é¢å¤–æ ·å¼ */
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-item {
      margin-bottom: 15px;
      display: flex;
      align-items: center;
    }
    
    .form-item label {
      width: 80px;
      text-align: right;
      margin-right: 20px;
      color: black;
    }
    
    /* ä¿®æ”¹è¾“å…¥æ¡†æ ·å¼ï¼Œä½¿å…¶åœ¨å¤§å±å¹•ä¸Šè‡ªé€‚åº”å®½åº¦ */
    .form-item input, .form-item textarea {
      width: 100%;
      max-width: 600px;
      border: 1px solid #CCCCCC;
      border-radius: 5px;
      padding: 5px 10px;
      box-sizing: border-box;
    }
    
    /* è®¢é˜…ä¸»é¢˜è¾“å…¥æ¡†æ ·å¼ */
    .form-item.add-topic-item {
      display: flex;
      flex-wrap: wrap;
    }
    
    .form-item.add-topic-item input {
      flex: 1;
      min-width: 200px;
      max-width: 600px;
    }
    
    .form-item textarea {
      height: 80px;
      resize: vertical;
    }
    
    .btn-primary {
      background-color: #1890FF;
      color: white;
      width: 70px;
      height: 35px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      transition: background-color .2s;
      margin-left: 10px;
    }
    
    .btn-primary:hover {
      background-color: #40a9ff;
    }
    
    .btn-danger {
      background-color: #ef2626;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
    }
    
    .error-message {
      margin-top: 5px;
      font-size: 14px;
      min-height: 20px;
    }
    
    /* è¡¨æ ¼å“åº”å¼æ ·å¼ */
    .responsive-table {
      width: 100%;
      max-width: 100%;
      overflow-x: auto;
    }
    
    /* ç¡®ä¿è¡¨æ ¼åœ¨å°å±å¹•ä¸Šèƒ½å¤Ÿå®Œæ•´æ˜¾ç¤º */
    .page-detail {
      overflow-x: auto;
      padding: 10px 0;
    }
    
    /* æ”¹è¿›é¡µé¢åˆ‡æ¢é€‰é¡¹å¡æ ·å¼ */
    .page-header {
      display: flex;
      margin-bottom: 20px;
      border-bottom: none;
      background-color: #f5f5f5;
      border-radius: 5px;
      overflow: hidden;
      height: 45px;
      padding-left: 0px;
    }
    
    .page-tab {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.2s ease;
      color: #666;
      border-bottom: 3px solid transparent;
      text-align: center;
    }
    
    .page-tab.active {
      background-color: #fff;
      color: #1890FF;
      font-weight: bold;
      border-bottom: 3px solid #1890FF;
    }
    
    .page-tab:hover:not(.active) {
      background-color: #e8e8e8;
    }
    
    .page-tab:before {
      content: "";
      font-family: sans-serif;
      margin-right: 6px;
      font-size: 18px;
    }
    
    .page-tab-subscribe:before {
      content: "ğŸ“¥";
    }
    
    .page-tab-publish:before {
      content: "ğŸ“¤";
    }
    
    .page-tab-settings:before {
      content: "âš™ï¸";
    }
    
    /* å¯†ç è¾“å…¥æ¡†æ ·å¼ */
    .password-container {
      position: relative;
      display: flex;
      flex: 1;
    }
    
    .toggle-password {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      color: #999;
    }
    
    /* ä¿®æ”¹è¡¨æ ¼åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šçš„æ˜¾ç¤º */
    @media (max-width: 768px) {
      .form-item {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .form-item label {
        margin-bottom: 5px;
        width: 100%;
        text-align: left;
      }
      
      .form-item input, .form-item textarea {
        width: 100%;
      }
      
      .btn-primary {
        margin-top: 10px;
        margin-left: 0;
      }
      
      /* é’ˆå¯¹ç§»åŠ¨è®¾å¤‡ä¼˜åŒ–è¡¨æ ¼ */
      .tableStyle {
        width: 100%;
        min-width: auto;
      }
      
      .tableStyle th:first-child {
        width: 70%;
      }
      
      .tableStyle th:last-child {
        width: 30%;
      }
      
      .tableStyle td, .tableStyle th {
        padding: 8px 5px;
      }
      
      /* ç¡®ä¿æŒ‰é’®åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šæ˜¾ç¤ºæ­£å¸¸ */
      .btn-danger {
        white-space: nowrap;
        padding: 5px 8px;
      }
      
      /* è°ƒæ•´å³ä¾§å†…å®¹åŒºåŸŸçš„è¾¹è· */
      .right-base {
        padding: 10px 5px;
      }
      
      /* é¡µé¢å†…å®¹åŒºåŸŸå®½åº¦è°ƒæ•´ */
      .page-content {
        padding: 10px 5px;
      }
    }
  </style>
</head>

<body>
  <div class="home-base">
    <div class="header-base flex flex-jcb">
      <img class="header-logo" src="./img/logoBlack.png">
      <div class="header-menu" onclick="menuClick(this)">
      </div>
    </div>
    <div class="content-base flex">
      <div class="left-base" id="leftMenu">
        <ul>
          <li>
            <a href="index.html">ç³»ç»ŸçŠ¶æ€</a>
          </li>
          <li>
            <a href="wlan.html">WLANè®¾ç½®</a>
          </li>
          <li>
            <a href="wifi_sta.html">WiFi STAè®¾ç½®</a>
          </li>
          <li>
            <a href="sensors.html">ä¼ æ„Ÿå™¨æ•°æ®</a>
          </li>
          <li>
            <a href="mqtt_topics.html" class="content">MQTTä¸»é¢˜ç®¡ç†</a>
          </li>
        </ul>
      </div>
      <div class="right-base">
        <div class="page-header">
          <div id="tabSubscribe" class="page-tab page-tab-subscribe active" onclick="showSubscribeTopics()">è®¢é˜…ä¸»é¢˜</div>
          <div id="tabPublish" class="page-tab page-tab-publish" onclick="showPublishPanel()">å‘å¸ƒæ¶ˆæ¯</div>
          <div id="tabSettings" class="page-tab page-tab-settings" onclick="showSettingsPanel()">MQTTè®¾ç½®</div>
        </div>

        <!-- è®¢é˜…ä¸»é¢˜é¢æ¿ -->
        <div class="page-content" id="subscribeTopicsPanel">
          <div class="page-title">å·²è®¢é˜…ä¸»é¢˜</div>
          <div class="page-detail">
            <table class="tableStyle tCenter">
              <thead>
                <tr>
                  <th>ä¸»é¢˜</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="topicsList"></tbody>
            </table>
          </div>
          
          <div class="page-title">æ·»åŠ è®¢é˜…ä¸»é¢˜</div>
          <div class="form-group">
            <div class="form-item add-topic-item">
              <input type="text" id="newTopic" placeholder="è¾“å…¥ä¸»é¢˜åç§°">
              <button class="btn-primary" onclick="addTopic()">æ·»åŠ </button>
            </div>
            <div class="error-message" id="topicError"></div>
          </div>
        </div>

        <!-- å‘å¸ƒæ¶ˆæ¯é¢æ¿ -->
        <div class="page-content" id="publishPanel" style="display: none;">
          <div class="page-title">å‘å¸ƒæ¶ˆæ¯</div>
          <div class="form-group">
            <div class="form-item">
              <label>ç›®æ ‡ä¸»é¢˜:</label>
              <input type="text" id="publishTopic" placeholder="è¾“å…¥å‘å¸ƒçš„ä¸»é¢˜åç§°">
            </div>
            <div class="form-item">
              <label>æ¶ˆæ¯å†…å®¹:</label>
              <textarea id="publishMessage" placeholder="è¾“å…¥è¦å‘å¸ƒçš„æ¶ˆæ¯å†…å®¹" rows="5"></textarea>
            </div>
            <div class="form-item">
              <button class="btn-primary" onclick="publishMessage()">å‘å¸ƒ</button>
            </div>
            <div class="error-message" id="publishError"></div>
          </div>
        </div>
        
        <!-- MQTTè®¾ç½®é¢æ¿ -->
        <div class="page-content" id="settingsPanel" style="display: none;">
          <div class="page-title">MQTTæœåŠ¡å™¨é…ç½®</div>
          <div class="form-group">
            <div class="form-item">
              <label>çŠ¶æ€:</label>
              <div id="mqttStatusDisplay">
                <span style="color: #999999;">âšª æœªè¿æ¥</span>
              </div>
            </div>
            <div class="form-item">
              <label>Broker:</label>
              <input type="text" id="mqttBroker" placeholder="ä¾‹å¦‚: mqtt://mqtt.example.com:1883">
            </div>
            <div class="form-item">
              <label>ç”¨æˆ·å:</label>
              <input type="text" id="mqttUsername" placeholder="MQTTç”¨æˆ·å(å¯é€‰)">
            </div>
            <div class="form-item">
              <label>å¯†ç :</label>
              <div class="password-container">
                <input type="password" id="mqttPassword" placeholder="MQTTå¯†ç (å¯é€‰)">
                <span class="toggle-password" onclick="togglePasswordVisibility()">ğŸ‘ï¸</span>
              </div>
            </div>
            <div class="form-item">
              <button class="btn-primary" style="width: 120px;" onclick="saveMqttSettings()">ä¿å­˜è®¾ç½®</button>
            </div>
            <div class="error-message" id="settingsError"></div>
            <div id="settingsSuccess" style="color: green; margin-top: 10px;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="js/mqtt_topics.js"></script>
</body>

</html> 